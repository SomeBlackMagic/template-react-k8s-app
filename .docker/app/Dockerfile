ARG DOCKER_SERVER_HOST
ARG DOCKER_SERVER_PORT
ARG DOCKER_PROJECT_PATH
ARG DOCKER_NODE_VERSION
ARG DOCKER_IMAGE_VERSION=master

FROM ${DOCKER_SERVER_HOST}:${DOCKER_SERVER_PORT}/${DOCKER_PROJECT_PATH}/node${DOCKER_NODE_VERSION}-yarn:${DOCKER_IMAGE_VERSION} as code

WORKDIR /app
COPY package.json /app
COPY yarn.lock /app

ARG NPM_INSTALL_CMD
RUN bash -c "${NPM_INSTALL_CMD}"

COPY . /app
RUN npm run build
